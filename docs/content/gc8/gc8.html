<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />

  <link rel="stylesheet" type="text/css" href="../../style.css">
  <script type="text/javascript" src="../../script.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/github.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>

  <!-- and it's easy to individually load additional languages -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/cpp.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/rust.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/llvm.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/languages/makefile.min.js"></script>

  <script>
    hljs.highlightAll();
    hljs.initLineNumbersOnLoad();
  </script>



  <!-- viz.js (graphviz) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/1.8.2/viz.js"></script>
  <script>
    window.addEventListener("DOMContentLoaded", function() {
      document.querySelectorAll(".graphviz")
        .forEach(e => e.innerHTML = Viz(e.textContent));
    });
  </script>

  <title>[WIP] Garbage Collection (Sec.8)</title>
  <meta name="keywords" content="GC"/>
  <meta name="date" content="yyyy-mm-dd"/>

  <style type="text/css">
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" />
</head>
<body>
<a href="../../index.html">トップへ</a>
<p>
  <date>yyyy-mm-dd</date>
      <tag><a href="../../tag.html?tag=GC">GC</a></tag>
  </p>

<h1
id="incremental-and-concurrent-garbage-collection-gc-81---84">Incremental
and Concurrent Garbage Collection (GC 8.1 - 8.4)</h1>
<p>Interactive / real-time
システムでは，GCのポーズ時間を減らしたい．</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: center;">Generational</th>
<th style="text-align: center;">Incremental</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">着眼点</td>
<td style="text-align: center;">平均計算量の削減</td>
<td style="text-align: center;">最悪計算量の削減</td>
</tr>
</tbody>
</table>
<h2 id="generational-gc-の問題点">Generational GC の問題点</h2>
<p>GCのポーズ時間を減らす手法として， generational GC (7章) を見た．<br>
しかし，このアルゴリズムは :</p>
<ul>
<li>“予想” が外れると上手く動かない．</li>
</ul>
<h2 id="incremental--real-time-gc">Incremental / Real-time GC</h2>
<ul>
<li>GCのポーズ時間を減らす手法．</li>
<li>目的 : 最悪計算量の削減．</li>
</ul>
<p>GC には，trace</p>
<p>Incremental GC の一例に，RC がある．</p>
<ul>
<li>ポインタの更新が遅い．</li>
<li>循環データ構造を扱えない．</li>
<li>→ ダメダメ．</li>
</ul>
<p>この章では incremental な tracing GC を見る．</p>
<p>なお，主に sequential (非並行) なマシンを扱う．</p>
<p>以降で紹介するアルゴリズムの一部は，元々マルチプロセッサ用に考案されたものを
sequential に適用したものである．</p>
<h2 id="sequential-gc">Sequential GC</h2>
<ul>
<li>ユーザプログラム と GC が並列に動かせば良い．</li>
<li>各 allocate 毎に k word 分だけグラフを trace
してマークすることを考える．
<ul>
<li>k が小さいほど
ポーズが<quiz>短く</quiz>，一時的なメモリリーク量は<quiz>多く</quiz>なる．</li>
</ul></li>
</ul>
<p>要件 : メモリが枯渇しないこと</p>
<ul>
<li>GC のあるサイクルの開始時に， <span class="math inline">R</span>
word が到達可能だったとする．</li>
<li>各 allocate では，<span class="math inline">1</span> word
確保し，<span class="math inline">k</span> word にマークを付ける．
<ul>
<li>確保したノードもマークする．</li>
</ul></li>
</ul>
<p>このとき，</p>
<ul>
<li><span class="math inline">R</span> word を全て mark するには， <span
class="math inline">\frac{R}{k}</span> 回の allocate が必要．</li>
<li>その間に確保されるのは <span class="math inline">\frac{R}{k}</span>
word．</li>
<li>よって，trace 完了時には</li>
</ul>
</body>
</html>
